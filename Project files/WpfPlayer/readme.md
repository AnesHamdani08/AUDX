This is where all the magic happens.
